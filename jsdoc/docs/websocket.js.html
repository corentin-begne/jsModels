<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Source: websocket.js</title>
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <meta name="keyword" content="" />
    <meta property="og:title" content=""/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content=""/>
    <meta property="og:site_name" content=""/>
    <meta property="og:url" content=""/>
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <script src="scripts/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/jaguar.css">
    
    
    <script>
    var config = {"monospaceLinks":true,"cleverLinks":true,"default":{"outputSourceFiles":true},"applicationName":"Beloola","disqus":"","googleAnalytics":"","openGraph":{"title":"","type":"website","image":"","site_name":"","url":""},"meta":{"title":"","description":"","keyword":""}};
    </script>
    

    
</head>
<body>
<div id="wrap" class="clearfix">
    
<div class="navigation">
    <h3 class="applicationName"><a href="index.html">Beloola</a></h3>

    <div class="search">
        <input id="search" type="text" class="form-control input-sm" placeholder="Search Documentations">
    </div>
    <ul class="list">
    
        <li class="item" data-name="namespace">
            <span class="title">
                <a href="namespace.html">namespace</a>
                
                <span class="static">static</span>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="ActionHelper">
            <span class="title">
                <a href="ActionHelper.html">ActionHelper</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="ActionHelper#getInstance"><a href="ActionHelper.html#getInstance">getInstance</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="ActionHelper#execute"><a href="ActionHelper.html#execute">execute</a></li>
            
                <li data-name="ActionHelper#redirect"><a href="ActionHelper.html#redirect">redirect</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="AnalyticsHelper">
            <span class="title">
                <a href="AnalyticsHelper.html">AnalyticsHelper</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="AnalyticsHelper#getInstance"><a href="AnalyticsHelper.html#getInstance">getInstance</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="AutocompletionHelper">
            <span class="title">
                <a href="AutocompletionHelper.html">AutocompletionHelper</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="AutocompletionHelper#addResult"><a href="AutocompletionHelper.html#addResult">addResult</a></li>
            
                <li data-name="AutocompletionHelper#changeResult"><a href="AutocompletionHelper.html#changeResult">changeResult</a></li>
            
                <li data-name="AutocompletionHelper#init"><a href="AutocompletionHelper.html#init">init</a></li>
            
                <li data-name="AutocompletionHelper#typingTimeout"><a href="AutocompletionHelper.html#typingTimeout">typingTimeout</a></li>
            
                <li data-name="AutocompletionHelper#updateResultContainer"><a href="AutocompletionHelper.html#updateResultContainer">updateResultContainer</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            <span class="subtitle">Events</span>
            
                <li data-name="AutocompletionHelper#event:hideResultContainer"><a href="AutocompletionHelper.html#event:hideResultContainer">hideResultContainer</a></li>
            
                <li data-name="AutocompletionHelper#event:removeSelected"><a href="AutocompletionHelper.html#event:removeSelected">removeSelected</a></li>
            
                <li data-name="AutocompletionHelper#event:selectResult"><a href="AutocompletionHelper.html#event:selectResult">selectResult</a></li>
            
                <li data-name="AutocompletionHelper#event:showResultContainer"><a href="AutocompletionHelper.html#event:showResultContainer">showResultContainer</a></li>
            
                <li data-name="AutocompletionHelper#event:typing"><a href="AutocompletionHelper.html#event:typing">typing</a></li>
            
            </ul>
        </li>
    
        <li class="item" data-name="Child">
            <span class="title">
                <a href="Child.html">Child</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="Child#testProperty"><a href="Child.html#testProperty">testProperty</a></li>
            
                <li data-name="Child#testPropertyInChild"><a href="Child.html#testPropertyInChild">testPropertyInChild</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="Child#returnObject"><a href="Child.html#returnObject">returnObject</a></li>
            
                <li data-name="Child#testMethod"><a href="Child.html#testMethod">testMethod</a></li>
            
                <li data-name="Child#testMethodInChild"><a href="Child.html#testMethodInChild">testMethodInChild</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="JsHelper">
            <span class="title">
                <a href="JsHelper.html">JsHelper</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="JsHelper#addGlobalFunction"><a href="JsHelper.html#addGlobalFunction">addGlobalFunction</a></li>
            
                <li data-name="JsHelper#cloneArray"><a href="JsHelper.html#cloneArray">cloneArray</a></li>
            
                <li data-name="JsHelper#cloneObject"><a href="JsHelper.html#cloneObject">cloneObject</a></li>
            
                <li data-name="JsHelper#extendSingleton"><a href="JsHelper.html#extendSingleton">extendSingleton</a></li>
            
                <li data-name="JsHelper#getSingleton"><a href="JsHelper.html#getSingleton">getSingleton</a></li>
            
                <li data-name="JsHelper#idDefined"><a href="JsHelper.html#idDefined">idDefined</a></li>
            
                <li data-name="JsHelper#ifNull"><a href="JsHelper.html#ifNull">ifNull</a></li>
            
                <li data-name="JsHelper#init"><a href="JsHelper.html#init">init</a></li>
            
                <li data-name="JsHelper#loadCss"><a href="JsHelper.html#loadCss">loadCss</a></li>
            
                <li data-name="JsHelper#ucfirst"><a href="JsHelper.html#ucfirst">ucfirst</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="namespace.Car">
            <span class="title">
                <a href="namespace.Car.html">namespace.Car</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="namespace.Car#testMethod"><a href="namespace.Car.html#testMethod">testMethod</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            <span class="subtitle">Events</span>
            
                <li data-name="namespace.Car#event:testEvent"><a href="namespace.Car.html#event:testEvent">testEvent</a></li>
            
            </ul>
        </li>
    
        <li class="item" data-name="PaginationHelper">
            <span class="title">
                <a href="PaginationHelper.html">PaginationHelper</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="PaginationHelper#checkNavigation"><a href="PaginationHelper.html#checkNavigation">checkNavigation</a></li>
            
                <li data-name="PaginationHelper#checkRange"><a href="PaginationHelper.html#checkRange">checkRange</a></li>
            
                <li data-name="PaginationHelper#init"><a href="PaginationHelper.html#init">init</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            <span class="subtitle">Events</span>
            
                <li data-name="PaginationHelper#event:updateCurrentpage"><a href="PaginationHelper.html#event:updateCurrentpage">updateCurrentpage</a></li>
            
            </ul>
        </li>
    
        <li class="item" data-name="Parent">
            <span class="title">
                <a href="Parent.html">Parent</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="Parent#testProperty"><a href="Parent.html#testProperty">testProperty</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="Parent#testMethod"><a href="Parent.html#testMethod">testMethod</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="PopupHelper">
            <span class="title">
                <a href="PopupHelper.html">PopupHelper</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="PopupHelper#getInstance"><a href="PopupHelper.html#getInstance">getInstance</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="SocketHelper">
            <span class="title">
                <a href="SocketHelper.html">SocketHelper</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="SocketHelper#getInstance"><a href="SocketHelper.html#getInstance">getInstance</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="SocketHelper#addEvent"><a href="SocketHelper.html#addEvent">addEvent</a></li>
            
                <li data-name="SocketHelper#init"><a href="SocketHelper.html#init">init</a></li>
            
                <li data-name="SocketHelper#send"><a href="SocketHelper.html#send">send</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            <span class="subtitle">Events</span>
            
                <li data-name="SocketHelper#event:disconnect"><a href="SocketHelper.html#event:disconnect">disconnect</a></li>
            
            </ul>
        </li>
    
        <li class="item" data-name="WebsocketHelper">
            <span class="title">
                <a href="WebsocketHelper.html">WebsocketHelper</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="WebsocketHelper#getInstance"><a href="WebsocketHelper.html#getInstance">getInstance</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="WebsocketHelper#addEvent"><a href="WebsocketHelper.html#addEvent">addEvent</a></li>
            
                <li data-name="WebsocketHelper#init"><a href="WebsocketHelper.html#init">init</a></li>
            
                <li data-name="WebsocketHelper#send"><a href="WebsocketHelper.html#send">send</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            <span class="subtitle">Events</span>
            
                <li data-name="WebsocketHelper#event:disconnect"><a href="WebsocketHelper.html#event:disconnect">disconnect</a></li>
            
            </ul>
        </li>
    
    </ul>
</div>
    <div class="main">
        <h1 class="page-title" data-filename="websocket.js.html">Source: websocket.js</h1>
        


    
    <section>
        <article>
            <pre class="prettyprint source"><code>/*global B, extendSingleton, getSingleton, UserHelper, isDefined, VoiceHelper */
var WebsocketHelper;
(function(){
    "use strict";
    /**
    * @name WebsocketHelper
    * @description To define socket events
    * @property {Object} [_socket = B.bClient._socket] Client socket instance
    * @constructor
    */
    WebsocketHelper = function(cb){      
        extendSingleton(WebsocketHelper);
        this.token;
        this.events = {
            onopen: this.connected.bind(this),
            onerror: this.error.bind(this),
            onclose: this.disconnected.bind(this),
            onmessage: this.recv.bind(this)
        };
        this.cbConnected;
        this.userEvents = {};
        cb(this);        
    };

    /**
     * @member WebsocketHelper#getInstance
     * @description get the single class instance
     * @return {WebsocketHelper} the single class instance
     */
    WebsocketHelper.getInstance = function(cb){
        if(isDefined(cb)){
            getSingleton(WebsocketHelper, cb);
        } else {
            return getSingleton(WebsocketHelper);
        }
    };

    /**
     * @method WebsocketHelper#init
     * @param  {Object} events Object containing all events to be set
     * @description Initialize socket events
     */
    WebsocketHelper.prototype.init = function(events){
        var that = this;
        
        $.each(events, addEvent);

        $(window).unbind("beforeunload");
        $(window).bind("beforeunload", disconnect);

        /**
         * @event WebsocketHelper#disconnect
         * @description Disconnect user socket on beforeunload event
         */
        function disconnect(event) {                  
            if (isDefined(that.socket)){
                that.socket.close();         
            }
        }

        /**
         * @description Add socket event
         * @method WebsocketHelper#addEvent
         * @private
         * @param  {String}   [event] Socket event name
         * @param  {Function} [cb]    Callback of the event
         */
        function addEvent(name, cb){
            that.socket[name] = cb;
        }
    };

    WebsocketHelper.prototype.addEvents = function(events){        
        $.each(events, this.addEvent.bind(this));
    };

    WebsocketHelper.prototype.addEvent = function(name, event){
        this.userEvents[name] = event;
    };

    /**
     * @description Send data by event to RTS
     * @method WebsocketHelper#send
     * @param  {String} [event] event to use
     * @param  {Object} [data]  data to send
     */
    WebsocketHelper.prototype.send = function(event, data){
        data = ifNull(data, {});
        data.token = this.token;        
        this.socket.send(JSON.stringify({
           type: event,
           data: data
        }));
    };

    WebsocketHelper.prototype.connect = function(url, data, cb){
        console.log("connecting to socket server ...");
        this.cbConnected = cb;
        try{
            this.socket = new WebSocket(url+(!isDefined(data) ? "" : "?"+$.param(data)));
            this.init(this.events); 
        } catch(exception){
            console.error(exception);
        }
    };

    WebsocketHelper.prototype.recv = function(event){
        var data = ifNull(event.data, $.parseJSON(event.data), {});
        if(!isDefined(this.userEvents[data.type])){
            console.error("socket event received but not defined", data);
            return false;
        }
        this.userEvents[data.type](data.data);
    };

    WebsocketHelper.prototype.connected = function(event){
        console.log("connected to socket server", event);
        if(isDefined(this.cbConnected)){
            this.cbConnected(event);
        }
    };

    WebsocketHelper.prototype.disconnected = function(){
        console.error("disconnected from socket server");
    };

    WebsocketHelper.prototype.error = function(){
        console.error("can't connect to socket server");
    };

})();</code></pre>
        </article>
    </section>





        

        <footer>
            Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Tue Jan 16 2018 10:47:32 GMT+0100 (CET)
        </footer>
    </div>
</div>
<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
<script src="scripts/main.js"></script>
</body>
</html>