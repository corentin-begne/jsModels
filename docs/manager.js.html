<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Source: manager.js</title>
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <meta name="keyword" content="" />
    <meta property="og:title" content=""/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content=""/>
    <meta property="og:site_name" content=""/>
    <meta property="og:url" content=""/>
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <script src="scripts/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/jaguar.css">
    
    
    <script>
    var config = {"monospaceLinks":true,"cleverLinks":true,"default":{"outputSourceFiles":true},"applicationName":"JsHelpers","disqus":"","googleAnalytics":"","openGraph":{"title":"","type":"website","image":"","site_name":"","url":""},"meta":{"title":"","description":"","keyword":""}};
    </script>
    

    
</head>
<body>
<div id="wrap" class="clearfix">
    
<div class="navigation">
    <h3 class="applicationName"><a href="index.html">JsHelpers</a></h3>

    <div class="search">
        <input id="search" type="text" class="form-control input-sm" placeholder="Search Documentations">
    </div>
    <ul class="list">
    
        <li class="item" data-name="ActionModel">
            <span class="title">
                <a href="ActionModel.html">ActionModel</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="ActionModel#getInstance"><a href="ActionModel.html#getInstance">getInstance</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="ActionModel#redirect"><a href="ActionModel.html#redirect">redirect</a></li>
            
                <li data-name="ActionModel#sendData"><a href="ActionModel.html#sendData">sendData</a></li>
            
                <li data-name="ActionModel#sendData"><a href="ActionModel.html#sendData">sendData</a></li>
            
                <li data-name="ActionModel#sendData"><a href="ActionModel.html#sendData">sendData</a></li>
            
                <li data-name="ActionModel#sendData"><a href="ActionModel.html#sendData">sendData</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="ManagerModel">
            <span class="title">
                <a href="ManagerModel.html">ManagerModel</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="ManagerModel#getInstance"><a href="ManagerModel.html#getInstance">getInstance</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
    </ul>
</div>
    <div class="main">
        <h1 class="page-title" data-filename="manager.js.html">Source: manager.js</h1>
        


    
    <section>
        <article>
            <pre class="prettyprint source"><code>/*global ActionModel, ucfirst, isDefined, extendSingleton, getSingleton, InterfaceHelper */
var ManagerModel;
(function(){
    "use strict";
    /**
    * @name ManagerModel
    * @constructor
    * @property {ActionModel} [action = new ActionModel()] Instance of ActionModel
    * @description Manage global manager functions and actions
    */
    ManagerModel = function(cb){        
        var that = this;
        extendSingleton(ManagerModel);                
        this.container = $("body");

        require([
            "bower_components/cb-models/action", 
        ], loaded);

        function loaded(){
            ActionModel.getInstance(loadedModel);

            function loadedModel(instance){
                that.actionModel = instance;
                if(isDefined(cb)){
                    cb(that);
                }
            }
        }
    };

    /**
     * @member ManagerModel#getInstance
     * @description get the single class instance
     * @return {ManagerModel} the single class instance
     */
    ManagerModel.getInstance = function(cb){
        if(isDefined(cb)){
            getSingleton(ManagerModel, cb);
        } else {
            return getSingleton(ManagerModel);
        }
    };

    ManagerModel.prototype.getVars = function(container){     
        var data = {};
        $(container).find(".varInterface").each(addData);

        function addData(i, element){
            data[$(element).attr("id")] = $(element).html().trim();
            $(element).remove();
        }
        return data;
    };

    ManagerModel.prototype.init = function(container) {
        var that = this;       
        this.container = isDefined(container) ? container : $('body');                    
        that.container.find(".action").each(addEvent);

        function addEvent(i, element){
            var events = $(element).is("[action-data]") ? $.parseJSON($(element).attr("action-data")) : {};

            if($.isArray(events)){
                events.forEach(createEvent);
            } else {
                createEvent(events);
            }

            function createEvent(data){
                if(isDefined(data.class)){
                    window[data.class].getInstance(loadedClass);                
                } else {
                    init();    
                }

                function loadedClass(instance){
                    data.class = instance;
                    init();
                }

                function init(){
                    if(!isDefined(data.type)){
                        data.type = "click";                    
                    }
                    if(data.type=== "init"){
                        that[data.fn](element, data);
                    } else {
                        $(element).unbind(data.type);
                        $(element).bind(data.type, sendEvent);
                    }

                    function sendEvent(event){                
                        data.fn = isDefined(data.fn) ? data.fn : "action";
                        if($(element).is("[preventDefault]")){
                            event.preventDefault();
                        }
                        if($(element).is("[stopPropagation]")){
                            event.stopPropagation();
                        }
                        if(isDefined(that[data.fn])){
                            that[data.fn](element, data, event);                    
                        }
                    }
                }
            }
            

            
        }
    };

    ManagerModel.prototype.autocompletion = function(element, data, event) {
        data.data.container = $(element);
        data.data.cbFind = data.class[data.data.cbFind].bind(data.class);
        data.data.cbSelect = data.class[data.data.cbSelect].bind(data.class);
        if(isDefined(data.data.cbBlur)){
            data.data.cbBlur = data.class[data.data.cbBlur].bind(data.class);
        }
        new AutocompletionHelper(data.data);
    };

    ManagerModel.prototype.action = function(element, data, event) {
        if(isDefined(data.class) &amp;&amp; isDefined(data.class[data.name])){
            data.class[data.name](element, event, data);
        }
    };

    ManagerModel.prototype.pagination = function(element, data, event) {
        data.class.pagination = new PaginationHelper({
            nbPage: data.data.nbPage,
            container: element,
            cb:data.class[data.data.cbContent].bind(data.class)
        });
    };

    ManagerModel.prototype.closeInterface = function(element, data, event) {
        $(element).parents("interface").remove();
    };

    ManagerModel.prototype.getPartial = function(element, data, event) {
        var that = this;
        this.actionModel.getHtml(data.path, data, check);

        function check(html){
            if(html === "error"){
                window.location.href = "/";
            } else {
                $(data.target).html(html);
                that.init($(data.target));
            }
        }
    };

    ManagerModel.prototype.getInterface = function(element, data, event) {
        var that = this;
        var name = data.path.split('/');
        name = ucfirst(name[1])+ucfirst(name[0]);
        $("interface#"+name).remove();
        if($(element).is("[modal]")){ // unique
            $("interface").remove();
        }
        // get css and manager if not exists
        if(!isDefined(window[name+"Manager"])){
            loadCss(basePath+'css/'+data.path+"/main.css");
            require([basePath.replace("/", "")+'js/'+data.path+"/manager.min"], ready);
        } else {
            ready();
        }

        function ready(){
            that.actionModel.getHtml(data.path, data, loaded);

            function loaded(html){
                if(html === "error"){
                    window.location.href = "/";
                } else {
                    var target = data.target || "body";
                    if(data.target){
                        $(target).empty();
                    }
                    $(target).append("&lt;interface id='"+name+"'>&lt;/interface>");
                    $("interface#"+name).append(html);
                    that.init($("interface#"+name));
                    window[name+"Manager"].getInstance(loadedManager);
                }

                function loadedManager(instance){
                    if(instance.init){
                        instance.init();
                    }
                }
            }
        }
    };

    ManagerModel.prototype.redirect = function(element, data, event) {
        this.actionModel.redirect(data.data.path, $(element).attr("type"));
    };


})();</code></pre>
        </article>
    </section>





        

        <footer>
            Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Tue Jan 16 2018 15:23:21 GMT+0100 (CET)
        </footer>
    </div>
</div>
<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
<script src="scripts/main.js"></script>
</body>
</html>